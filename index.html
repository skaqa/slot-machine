<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Slot Machine with Scoring</title>
<style>
  body { 
    background: #222; 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    font-family: 'Segoe UI', sans-serif;
    color: white;
  }
  
  .scoreboard { margin-top: 20px; font-size: 24px; color: gold; }
  .status { height: 30px; margin: 10px; font-weight: bold; color: #00ff00; }

  .machine { display: flex; gap: 15px; margin-bottom: 20px; background: #444; padding: 20px; border-radius: 20px; border: 4px solid #666; }
  
  .reel {
    width: 100px; 
    height: 100px; 
    border: 3px solid #222;
    background: #000; 
    overflow: hidden; 
    position: relative;
    font-size: 60px;
    border-radius: 10px;
  }

  .strip {
    position: absolute;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    /* Transition is set in JS */
  }

  .symbol {
    height: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  button {
    padding: 15px 40px;
    font-size: 24px;
    cursor: pointer;
    background: gold;
    border: none;
    font-weight: bold;
    border-radius: 50px;
    box-shadow: 0 4px #b8860b;
  }
  button:active { transform: translateY(2px); box-shadow: 0 2px #b8860b; }
  button:disabled { background: #666; box-shadow: none; cursor: not-allowed; }
</style>
</head>
<body>

<div class="scoreboard">Total Score: <span id="total-score">0</span></div>
<div class="status" id="status-msg"></div>

<div class="machine">
  <div class="reel"><div class="strip" id="r1"></div></div>
  <div class="reel"><div class="strip" id="r2"></div></div>
  <div class="reel"><div class="strip" id="r3"></div></div>
</div>

<button id="spin-btn" onclick="spin()">SPIN</button>

<script>
// 1. Configuration
const symbols = ["ðŸ’", "ðŸ‹", "ðŸ””", "7ï¸âƒ£", "â­"];
const symbolScores = {
  "ðŸ’": 10,
  "ðŸ‹": 20,
  "ðŸ””": 50,
  "7ï¸âƒ£": 100,
  "â­": 500
};

const symbolHeight = 100;
const totalScoreElem = document.getElementById('total-score');
const statusElem = document.getElementById('status-msg');
const spinBtn = document.getElementById('spin-btn');
let totalScore = 0;

// 2. Setup Reels
document.querySelectorAll(".strip").forEach(strip => {
  // Create a long strip (repeat symbols 10 times for a long spin)
  const content = [];
  for(let i=0; i<10; i++) content.push(...symbols);
  
  content.forEach(s => {
    const div = document.createElement('div');
    div.className = 'symbol';
    div.innerText = s;
    strip.appendChild(div);
  });
});

function spin() {
  // Disable button and clear status
  spinBtn.disabled = true;
  statusElem.innerText = "";
  
  const results = [];

  document.querySelectorAll(".strip").forEach((strip, i) => {
    // Reset position instantly
    strip.style.transition = 'none';
    strip.style.transform = `translateY(0px)`;
    strip.offsetHeight; // Force reflow

    // Pick a random landing index (0 to 4)
    const landingIndex = Math.floor(Math.random() * symbols.length);
    const landingSymbol = symbols[landingIndex];
    results.push(landingSymbol);

    // Calculate move: (Move 5 full sets + the target)
    const rotations = 5 + i; // Each reel spins a bit longer than the previous
    const totalMove = (rotations * symbols.length + landingIndex) * symbolHeight;

    strip.style.transition = `transform ${2 + i * 0.5}s cubic-bezier(0.45, 0.05, 0.55, 0.95)`;
    strip.style.transform = `translateY(-${totalMove}px)`;
  });

  // 3. Logic Check (Wait for the longest animation to finish)
  const longestAnimationTime = (2 + (2 * 0.5)) * 1000; 

  setTimeout(() => {
    checkWin(results);
    spinBtn.disabled = false;
  }, longestAnimationTime);
}

function checkWin(results) {
  const [r1, r2, r3] = results;

  if (r1 === r2 && r2 === r3) {
    const winAmount = symbolScores[r1];
    totalScore += winAmount;
    
    // Update UI
    statusElem.innerText = `JACKPOT! You won ${winAmount} points! ðŸŽŠ`;
    statusElem.style.color = "gold";
    totalScoreElem.innerText = totalScore;
    
    // Optional: Visual feedback
    document.querySelector('.machine').style.borderColor = "gold";
    setTimeout(() => document.querySelector('.machine').style.borderColor = "#666", 1000);
  } else {
    statusElem.innerText = "Try Again!";
    statusElem.style.color = "#ff4444";
  }
}
</script>

</body>
</html>
